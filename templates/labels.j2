# SPDX-FileCopyrightText: 2025 Pavel Dimov <@sagat79>
#
# SPDX-License-Identifier: AGPL-3.0-or-later

# LittleLink Server Container Labels
# Generated by Ansible role: ansible-role-littlelink-server

# Traefik labels
{% if littlelink_server_container_labels_traefik_enabled %}
traefik.enable=true
traefik.docker.network={{ littlelink_server_container_labels_traefik_docker_network }}
traefik.http.routers.{{ littlelink_server_identifier }}.rule={{ littlelink_server_container_labels_traefik_rule }}
traefik.http.routers.{{ littlelink_server_identifier }}.priority={{ littlelink_server_container_labels_traefik_priority }}
traefik.http.routers.{{ littlelink_server_identifier }}.entrypoints={{ littlelink_server_container_labels_traefik_entrypoints }}
{% if littlelink_server_container_labels_traefik_tls %}
traefik.http.routers.{{ littlelink_server_identifier }}.tls=true
traefik.http.routers.{{ littlelink_server_identifier }}.tls.certresolver={{ littlelink_server_container_labels_traefik_tls_certResolver }}
{% endif %}

# Basic auth middleware
{% if littlelink_server_container_labels_middleware_basic_auth_enabled %}
traefik.http.routers.{{ littlelink_server_identifier }}.middlewares={{ littlelink_server_identifier }}-basic-auth
traefik.http.middlewares.{{ littlelink_server_identifier }}-basic-auth.basicauth.users={{ littlelink_server_container_labels_middleware_basic_auth_users }}
{% endif %}

# Additional request headers
{% for header_name, header_value in littlelink_server_container_labels_traefik_additional_request_headers.items() %}
traefik.http.middlewares.{{ littlelink_server_identifier }}-request-headers.headers.customrequestheaders.{{ header_name }}={{ header_value }}
{% endfor %}

# Additional response headers
{% for header_name, header_value in littlelink_server_container_labels_traefik_additional_response_headers.items() %}
traefik.http.middlewares.{{ littlelink_server_identifier }}-response-headers.headers.customresponseheaders.{{ header_name }}={{ header_value }}
{% endfor %}

# Apply middlewares if any headers are set
{% if littlelink_server_container_labels_traefik_additional_request_headers %}
traefik.http.routers.{{ littlelink_server_identifier }}.middlewares={{ littlelink_server_identifier }}-request-headers
{% endif %}
{% if littlelink_server_container_labels_traefik_additional_response_headers %}
traefik.http.routers.{{ littlelink_server_identifier }}.middlewares={{ littlelink_server_identifier }}-response-headers
{% endif %}
{% endif %}

# Additional custom labels
{{ littlelink_server_container_labels_additional_labels }}
